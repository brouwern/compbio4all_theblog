---
title: "Overlaying a barplot with a line graph in base R"
description: |
  A short description of the post.
author: Nathan L. Brouwer
date: 2022-05-05
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

Data extracted from Figure 4 of Foley and Faust (2010) using metaDigitise.

[Foley and Faust 2010](https://www.cambridge.org/core/journals/oryx/article/rapid-population-growth-in-an-elephant-loxodonta-africana-population-recovering-from-poaching-in-tarangire-national-park-tanzania/2DADFFCB562E9553B1DF7688EB372FBF.  Rapid population growth in an elephant *Loxodonta africana* population recovering from poaching in Tarangire National Park, Tanzania.  Oryx 44:205 - 212.  https://doi.org/10.1017/S0030605309990706

"Poaching virtually ceased in the Park following the 1989 ivory ban and during the study there were no known poaching incidents in the northern subpopulation."

```{r}
Year <- 1994:2005
N <- c(226,232,292,311,313,345,406,411,440,494,485,498)
plot(N ~ Year, type = "b")
```


```{r}
month.i <- 1:12
month.order <- c("Nov","Dec","Jan","Fen","Mar","Apr","May","Jun","July","Aug", "Sep","Oct")
conceptions <- c(10, 42,34,18, 30, 55,68, 48,24,23,11,8)
rainfall    <- c(60,100,95,78,130,160,58,  4, 3, 3, 2,18)

plot(conceptions ~ rainfall)
```

```{r}
#library
library(latticeExtra)
 
# create data
df <- data.frame(month.i, month.order, conceptions, rainfall)

 
 
# --> construct separate plots for each series
obj1 <- barchart(conceptions ~ month.i, df, 
                 type = "l" , 
                horizontal = F,
                 lwd=2, col="darkgrey", 
                ylab = "Conceptions (grey bars)", 
                xlab = "Month", 
                main = "Elephant conceptions vs. rainfall, Tarangire NP Tanzania")
# obj1 <- dotplot(conceptions ~ month.i, df, 
#                 #horizontal = F,
#                  #type = "l" , 
#                 # lwd=2, 
#         col="steelblue")


obj2 <- xyplot(rainfall ~ month.i, df, type = "b", lwd=3, cex = 2, pch = 18, 
               ylab = "Rainfall (mm; blude triangles)",
               xlab = "Conceptions")
 
# --> Make the plot with second y axis:
doubleYScale(obj1,obj2, add.ylab2 = TRUE, use.style=FALSE ,xlab = "")

```

