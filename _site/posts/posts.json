[
  {
    "path": "posts/2023-01-19-overlaying-a-barplot-with-a-line-graph-in-base-r/",
    "title": "Overlaying a barplot with a line graph in base R",
    "description": "Creating a dual-axis, dual-element graph.",
    "author": [
      {
        "name": "Nathan L. Brouwer",
        "url": {}
      }
    ],
    "date": "2023-01-19",
    "categories": [
      "base R",
      "dataviz"
    ],
    "contents": "\n\n\n\nFigure 1: Foley & Faust (2010), Fig. 4\n\n\n\nhttps://r-graph-gallery.com/145-two-different-y-axis-on-the-same-plot.html\nA relatively type of plot in wildlife ecology is a dual-axis graph representing some aspect of a population using one axis, like birth rate, and the second representing an aspect of the environment.\nThere are arrangements for why dual-axis plots are a poor choice for data viz, but I wanted to be able to show my students how to make them. I’ll use base R and lattice graphics in this post and perhaps try ggplot2 in the future.\nThe example shown above is from a paper on African elephants by Foley and Faust 2010. Called “Rapid population growth in an elephant Loxodonta africana population recovering from poaching in Tarangire National Park, Tanzania”, in the animal conservation journal Oryx.\nThe left axis shows the estimated number of conceptions in the population (determined by back-calculating from date of birth) and the right axis shows rainfall. It appears that elephant conception (and subsequent birth) is timed with the rains.\nI extracted the data from Figure 4 of Foley and Faust (2010) using [metaDigitise](https://cran.r-project.org/web/packages/metaDigitise/vignettes/metaDigitise.html.\nThe dataset is small and reproduced below:\n\n\n\nEasy plot choice: side by side\nThe easiest way to display the data is in two side-by-side figures. I’ll use the function mtext() for the axes labels instead of the default locations.\n\n\n\nA dual axis graph\nA dual-axis plot can be made using lattice graphics. I’ll make two separate plots, one barplot using lattice::barplot(), one line plot using lattice::xyplot, then overlay them.\nFirst, I need lattice and latticeExtra.\n\n\n\nI’l bundel the data into a dataframe for convience\n\n\n\nNow first, a barplot for the conceptions, stored in an object.\n\n\n\nThis looks nice enough:\n\n\n\nNow the rainfall data using xyplot.\n\n\n\nThe plots are overlaid with dual axes using latticeExtra::doubleYScale\n\n\n\nReferences\nFoley and Faust 2010](https://www.cambridge.org/core/journals/oryx/article/rapid-population-growth-in-an-elephant-loxodonta-africana-population-recovering-from-poaching-in-tarangire-national-park-tanzania/2DADFFCB562E9553B1DF7688EB372FBF). Called Rapid population growth in an elephant Loxodonta africana population recovering from poaching in Tarangire National Park, Tanzania. Oryx 44:205 - 212. https://doi.org/10.1017/S0030605309990706\n\n\n\n",
    "preview": "posts/2023-01-19-overlaying-a-barplot-with-a-line-graph-in-base-r/overlaying-a-barplot-with-a-line-graph-in-base-r_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2023-01-19T19:22:05-05:00",
    "input_file": {},
    "preview_width": 1248,
    "preview_height": 768
  },
  {
    "path": "posts/2022-05-05-welcome-to-computational-biology-for-all/",
    "title": "Welcome to Computational Biology for All!",
    "description": "Welcome to my new blog, Computational Biology for All!",
    "author": [
      {
        "name": "Nathan L. Brouwer",
        "url": "https://www.linkedin.com/in/nathan-brouwer-phd-97100980/"
      }
    ],
    "date": "2022-05-05",
    "categories": [],
    "contents": "\n\n\n\nWelcome to Computational Biology for All. This blog is dedicated to introducing and explaining quantitative methods to biologists.\nTopics will include:\ndata science\nstatistical analysis\ndata visualization\ncomputational biology\nbioinformatics\nphylogenetics\nsimulation\n\n\n\n",
    "preview": "posts/2022-05-05-welcome-to-computational-biology-for-all/asciiworld.png",
    "last_modified": "2023-01-19T16:27:35-05:00",
    "input_file": {},
    "preview_width": 645,
    "preview_height": 427
  }
]
